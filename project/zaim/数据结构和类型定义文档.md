# 数据结构和类型定义文档

## 文档概述

本文档详细分析了项目中的数据结构定义、类型系统设计以及业务常量配置，为开发者提供完整的数据模型参考。

## 1. 核心类型定义

### 1.1 请求响应类型

```typescript
// types/index.ts
export interface RequestResult<T> {
  errno: 0 | number;      // 错误码，0表示成功
  msg: string;            // 响应消息
  ts: number;             // 时间戳
  data: T                 // 响应数据，泛型类型
}
```

**设计特点：**
- 使用泛型 `<T>` 支持任意数据类型
- `errno` 字段采用 `0 | number` 联合类型，明确成功状态
- 统一的响应格式便于错误处理和数据解析

### 1.2 自定义错误类型

```typescript
export class CustomError extends Error {
  errorno: number;
  msg: string;

  constructor(errorno: number, msg: string) {
    super(msg);
    this.errorno = errorno;
    this.msg = msg;
  }
}
```

**特点：**
- 继承原生 `Error` 类，保持错误处理一致性
- 扩展错误码字段，支持业务错误分类
- 自定义错误消息，提供详细错误信息

### 1.3 页面状态类型

```typescript
export interface PageStatus {
  status: 'error' | 'ready' | 'loading';
  errorMsg?: string
}
```

**状态管理：**
- `loading`: 数据加载中
- `ready`: 数据就绪
- `error`: 加载失败
- `errorMsg`: 可选错误消息

### 1.4 业务枚举类型

```typescript
// 协议类型枚举
export enum AgreementType {
  default = 0,
  agreement = 1,        // 用户协议
  privacy,             // 隐私政策
  disclaimer,          // 免责声明
  about,              // 关于我们
  zaierHelp,          // 助手帮助
  removeAccount = 9    // 注销账户
}

// 认证状态枚举
export enum CertificationStatus {
  saved,               // 已保存
  done,                // 已测评
  doneAI,              // 已完成AI测评
  deleted              // 已删除
}
```

## 2. 业务常量配置

### 2.1 学历相关常量

```typescript
// 学历类型映射
export const EDUCATION_SCHOOL_TYPE = {
  1: "大学专科",
  2: '大学本科/学士学位',
  3: '硕士研究生/硕士学位',
  4: '博士研究生/博士学位'
}

// 学历要求映射
export const EDUCATION_MAP = {
  0: '不限',
  1: '大专以上',
  2: '本科以上',
  3: '硕士以上',
  4: '博士',
};

// 学历选项列表
export const EDUCATION_LIST = [
  { label: '无要求', value: 0 },
  { label: '大专以上', value: 1 },
  { label: '本科以上', value: 2 },
  { label: '硕士以上', value: 3 },
  { label: '博士', value: 4 },
];
```

### 2.2 工作经验配置

```typescript
// 经验要求列表
export const EXPERIENCE_LIST = [
  { label: '无要求', value: 0 },
  { label: '1 年以内', value: 1 },
  { label: '1~3 年', value: 2 },
  { label: '3~5 年', value: 3 },
  { label: '5~10 年', value: 4 },
  { label: '10 年以上', value: 5 },
];

// 经验映射
export const EXPERIENCE_MAP = {
  0: '不限',
  1: '1 年以内',
  2: '1~3 年',
  3: '3~5 年',
  4: '5~10 年',
  5: '10 年以上',
};
```

### 2.3 工作类型配置

```typescript
// 工作类型定义
export const WORK_TYPE = {
  0: '不限',
  1: '全职/兼职均可',
  2: '全职',
  3: '兼职',
};

// 工作类型选项（按优先级排序）
export const WORK_TYPE_LIST = [0,2,3,1].map(key => ({
  value: key,
  label: WORK_TYPE[key as 2]
}))
```

### 2.4 技术级别评估系统

项目定义了完整的L1-L10技术级别评估体系：

```typescript
export const ZAIER_LEVEL_LIST = [
  {
    label: 'L1 / 实习研发工程师',
    value: 1,
    role: '一般适用于在校大学生或应届毕业生。',
    ability: '具备基础的编程知识和技术理解，能够在导师指导下参与简单功能的研发工作...'
  },
  // ... L2-L10 级别定义
  {
    label: 'L10 / 首席架构师',
    value: 10,
    role: '一般适用于工作 15 ~ 30+ 年的首席架构师，可担任大型公司技术负责人。',
    ability: '在行业内具有极高的技术影响力和声望，能够洞察行业技术趋势...'
  }
];
```

**级别体系特点：**
- 完整的10级技术评估体系
- 每个级别包含适用人群、角色定位、能力要求
- 从实习生到首席架构师的完整职业路径
- 工作年限和责任范围的明确划分

### 2.5 公司规模配置

```typescript
// 公司规模映射
export const HEADCOUNT_MAP = {
  1: '1-20 人',
  2: '21-99 人',
  3: '100-499 人',
  4: '500-999 人',
  5: '1000-9999 人',
  6: '10000 人以上',
};

// 规模选项（包含不限选项）
export const HEADCOUNT_OPTIONS = [
  { name: '不限', value: 0 },
  { name: '1-20 人', value: 1 },
  // ... 其他选项
];
```

### 2.6 求职相关配置

```typescript
// 求职紧急程度
export const URGENT_LIST = [{
  label: '正常匹配',
  value: 0
}, {
  label: '加急匹配',
  value: 1
}]

// 到岗时间选项
export const ENTRY_TIME_LIST = [{
  label: '暂不确定',
  value: 0,
}, {
  label: '一周内',
  value: 1,
}, {
  label: '1 个月内',
  value: 2,
}, {
  label: '3 个月内',
  value: 3
}, {
  label: '半年内',
  value: 4
}]

// 性别选项
export const GENDER = [{
  value: 1,
  text: '男'
}, {
  value: 2,
  text: '女'
}]
```

## 3. 环境配置常量

### 3.1 环境判断

```typescript
// 生产环境判断
export const isProduction = process.env.NODE_ENV === 'production';

// API基础URL配置
export const BASE_URL = !isProduction ? 'http://dev.zizai.work' : 'https://zizai.work';
```

### 3.2 应用类型配置

```typescript
// 是否是招聘小程序
export const IS_HIRE = false;
```

**配置特点：**
- 通过常量控制应用类型
- 支持多种应用形态的配置切换
- 便于条件编译和功能开关

## 4. 工具函数和辅助类型

### 4.1 时间处理工具

```javascript
// common/util.js
var dateUtils = {
  UNITS: {
    '年': 31557600000,
    '月': 2629800000,
    '天': 86400000,
    '小时': 3600000,
    '分钟': 60000,
    '秒': 1000
  },
  humanize: function(milliseconds) {
    // 人性化时间显示
    var humanize = '';
    for (var key in this.UNITS) {
      if (milliseconds >= this.UNITS[key]) {
        humanize = Math.floor(milliseconds / this.UNITS[key]) + key + '前';
        break;
      }
    }
    return humanize || '刚刚';
  },
  format: function(dateStr) {
    // 格式化日期显示
    var date = this.parse(dateStr)
    var diff = Date.now() - date.getTime();
    if (diff < this.UNITS['天']) {
      return this.humanize(diff);
    }
    // 返回具体日期时间
    return date.getFullYear() + '/' + _format(date.getMonth() + 1) + '/' + _format(date.getDate()) + '-' +
      _format(date.getHours()) + ':' + _format(date.getMinutes());
  }
};
```

### 4.2 位置格式化工具

```javascript
function formatLocation(longitude, latitude) {
  if (typeof longitude === 'string' && typeof latitude === 'string') {
    longitude = parseFloat(longitude)
    latitude = parseFloat(latitude)
  }

  longitude = longitude.toFixed(2)
  latitude = latitude.toFixed(2)

  return {
    longitude: longitude.toString().split('.'),
    latitude: latitude.toString().split('.')
  }
}
```

## 5. 页面标题管理

```typescript
// 自动生成的页面标题映射
export { default as PAGE_TITLE_MAP } from './page-titles-auto'
```

**特点：**
- 自动化页面标题管理
- 统一的标题配置体系
- 支持多语言和动态标题

## 6. 数据结构设计原则

### 6.1 类型安全
- 使用 TypeScript 严格类型检查
- 枚举类型避免魔法数字
- 泛型支持类型复用

### 6.2 可维护性
- 常量集中管理
- 映射表和列表数据分离
- 语义化的命名规范

### 6.3 扩展性
- 预留扩展字段
- 版本兼容考虑
- 模块化组织结构

### 6.4 国际化支持
- 中文业务术语标准化
- 支持多语言扩展
- 本地化数据配置

## 7. 最佳实践建议

### 7.1 类型定义
- 优先使用接口而非类型别名
- 合理使用可选属性
- 避免 `any` 类型

### 7.2 常量管理
- 分类组织业务常量
- 使用枚举替代魔法数字
- 常量名称语义化

### 7.3 数据验证
- 前端数据类型检查
- 运行时数据验证
- 错误状态处理

---

*本文档为项目数据结构和类型定义的完整参考，建议开发者在编码前仔细阅读相关类型定义，确保数据处理的一致性和安全性。*