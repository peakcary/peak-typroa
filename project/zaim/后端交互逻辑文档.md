# 自在招聘后端交互逻辑文档

## 概述

本文档详细介绍自在招聘前端应用与后端服务的交互机制，包括接口调用、认证授权、数据格式转换、错误处理等核心内容。

## 1. 后端接口调用架构

### 1.1 整体架构图

```
前端组件/页面
    ↓
业务逻辑层 (Services)
    ↓  
请求封装层 (Utils/Request)
    ↓
网络传输层 (UniApp Request)
    ↓
后端API服务
```

### 1.2 核心技术栈

- **请求库**: UniApp的`uni.request`
- **状态管理**: Pinia Store
- **类型系统**: TypeScript
- **数据转换**: 自定义工具函数
- **错误处理**: 统一异常处理机制

## 2. 请求封装和配置

### 2.1 基础请求封装 (`utils/request.ts`)

```typescript
const TOKEN_HEADER_KEY = 'zai-token';
const BASE_URL = 'http://dev.zizai.work/'; // 开发环境

export function request(object: RequestParams): void {
  // 自动添加token
  const token = tokenMethod.get();
  const header: RequestParams['header'] = {};
  if (token) {
    header[TOKEN_HEADER_KEY] = token;
  }
  
  // 自动拼接BASE_URL (非H5环境)
  if (!object.url.startsWith('http')) {
    object.url = BASE_URL + object.url;
  }
  
  uni.request({
    ...object,
    header: { ...object.header, ...header },
    success: wrapSuccessCallback(object.success),
  })
}
```

### 2.2 Promise化请求封装

```typescript
export function requestPromise<T>(object: RequestParams): Promise<T> {
  return new Promise((resolve, reject) => {
    request({
      ...requestOptions,
      success(res) {
        const response = res.data as RequestResult<T>
        if (response.errno !== 0) {
          // 统一错误处理
          const error = new CustomError(response.errno, response.msg)
          reject(error)
          
          // Token失效处理
          if ([100000, 100008].includes(response.errno)) {
            tokenMethod.clear();
            const userStore = useUserStore()
            userStore.setUserinfo({} as any)
            const pageWrapperStore = usePageWrapperStore()
            pageWrapperStore.setLoginVisible(true)
          }
        } else {
          resolve(response.data)
        }
      },
      fail(e) {
        if (e?.errMsg.includes('request:fail abort')) {
          uni.showToast({
            icon: 'none',
            title: '请求失败，请检查网络~'
          })
        }
      }
    })
  })
}
```

### 2.3 统一响应格式

```typescript
interface RequestResult<T> {
  errno: 0 | number;    // 错误码，0表示成功
  msg: string;          // 错误消息
  ts: number;           // 时间戳
  data: T;              // 响应数据
}
```

## 3. 认证和权限机制

### 3.1 Token管理

#### Token存储策略
```typescript
const TOKEN_STORAGE_KEY = 'zai-token';
const USERPIN_STOREAGE_KEY = 'zaier-pin';

export function tokenUtil() {
  return {
    get() {
      return uni.getStorageSync(TOKEN_STORAGE_KEY);
    },
    set(token: string) {
      uni.setStorageSync(TOKEN_STORAGE_KEY, token);
    },
    clear() {
      uni.removeStorageSync(TOKEN_STORAGE_KEY)
    }
  }
}
```

#### Token使用流程
1. **请求时**: 自动从本地存储读取token，添加到请求头
2. **响应时**: 检查响应头中的新token，自动更新本地存储
3. **失效时**: 收到401错误时，清除本地token，弹出登录界面

### 3.2 用户认证流程

#### 支持的登录方式

**1. 手机验证码登录**
```typescript
// 获取验证码
GET /api/user/getreglogincode
{
  mobile: string
}

// 登录
POST /api/user/smsreglogin
{
  mobile: string,
  code: string,
  referrerPin?: string
}
```

**2. 微信小程序授权登录**
```typescript
POST /api/user/wxreglogin
{
  code: string,           // 微信授权code
  referrerPin?: string,   // 推荐人pin
  xcxType: 'zizaiZhaopin' | 'zizaiTool'
}
```

**3. APP微信登录**
```typescript
POST /api/user/wxlogin
{
  code: string,
  state: string,
  referrerPin?: string
}
```

**4. 一键登录 (App端)**
```typescript
POST /api/user/univerifylogin
{
  access_token: string,
  openid: string,
  referrerPin?: string
}
```

#### 登录成功后的处理流程
1. **保存token**: 将返回的token存储到本地
2. **获取用户信息**: 调用`/api/user/getinfo`获取用户详细信息
3. **更新状态**: 更新Pinia store中的用户状态
4. **跳转页面**: 根据业务逻辑跳转到相应页面

### 3.3 权限检查机制

#### useAuthTrigger Hook
```typescript
export const useAuthTrigger = <T extends ((...args: any[]) => void)>(handler: T) => {
  const handleTrigger = (...args: Parameters<typeof handler>) => {
    const { isLogin } = useLoginStatus()
    if (isLogin.value) {
      handler(...args)  // 已登录，执行原函数
    } else {
      // 未登录，弹出登录界面
      const pageWrapperStore = usePageWrapperStore()
      pageWrapperStore.setLoginVisible(true)
    }
  }
  return { trigger: handleTrigger }
}
```

#### 使用示例
```typescript
// 在组件中使用
const { trigger: handleCollect } = useAuthTrigger(async () => {
  await updateWorkCollect(workPin, true)
})

// 点击收藏时
<button @click="handleCollect">收藏</button>
```

## 4. API服务层设计

### 4.1 服务层模块划分

```
services/
├── index.ts          # 核心API集合
├── account.ts        # 账户相关服务
├── activity.ts       # 活动相关服务
├── certification.ts  # 认证相关服务
├── entity.ts         # 企业主体服务
├── job.ts           # 职位相关服务
└── zaier.ts         # 求职者相关服务
```

### 4.2 主要API接口分类

#### 用户管理接口

**获取用户信息**
```typescript
export const queryUserInfo = (pin: string) => {
  return requestPromise<{
    pin: string;
    un: string;
    uname: string;
    mobile: string;
    email: string;
    headshot: string;
    hasPw: boolean;
    hasApw: boolean;
    hasResume: 0 | 1;
    hasAiExam: 0 | 1;
    hasFieldExam: 0 | 1;
    hasWork: 0 | 1;
    hasSomeFieldExam: 0 | 1;
  }>({
    url: '/api/user/getinfo',
    method: 'POST',
    data: { pin }
  });
};
```

**更新用户信息**
```typescript
// 更新用户名
export const updateUn = (un: string) => {
  return requestPromise({
    url: '/api/user/renameun',
    method: 'POST',
    data: { un }
  });
};

// 更新花名
export const updateUsername = (uname: string) => {
  return requestPromise({
    url: '/api/user/renameuname',
    method: 'POST',
    data: { uname }
  });
};

// 更新绑定手机号
export const updateMobile = (code: string, mobile: string) => {
  return requestPromise({
    url: '/api/user/bindupdatemobile',
    method: 'POST',
    data: { code, mobile }
  });
};
```

#### 简历管理接口

**获取简历**
```typescript
export const queryResume = () => {
  return requestPromise<ResumeResponse>({
    url: '/api/zaier/getresume',
    method: 'POST'
  });
};
```

**更新简历**
```typescript
export const updateResume = (resume: ResumeResponse) => {
  return requestPromise({
    url: '/api/zaier/saveresume',
    method: 'POST',
    data: resume
  });
};
```

**AI简历优化**
```typescript
// 润色简历
export const polishResume = (requestData: PolishResumeParams) => {
  return requestPromise({
    url: '/api/zaier/polishresume',
    method: 'POST',
    data: requestData,
  });
};

// 优化简历
export const optimizeResume = () => {
  return requestPromise({
    url: '/api/zaier/optimizeresume',
    method: 'POST',
    timeout: 120000  // 2分钟超时
  });
};
```

**简历上传和解析**
```typescript
// 上传简历文件
export const uploadResume = (resume: File) => {
  const formData = new FormData();
  formData.append('fileType', 'pdf');
  formData.append('resume', resume);
  return requestPromise<{ taskId: string }>({
    url: '/api/zaier/uploadresume',
    method: 'POST',
    header: { 'Content-Type': 'multipart/form-data' },
    dataType: 'formData',
    data: formData
  });
};

// 获取解析结果
export const queryParsedResume = (taskId: number) => {
  return requestPromise<{ status: 1 | 2; resume: ResumeResponse }>({
    url: '/api/zaier/getparsedresume?taskId=' + taskId,
    method: 'GET'
  });
};
```

#### AI测评接口

**获取测评状态**
```typescript
export const queryZaierStatus = (params?: { fid?: number }) => {
  return requestPromise<{
    hasResume: boolean;
    hasAiExam: boolean;
    hasFieldExam: boolean;
    hasReal: boolean;
    isOpen: boolean;
  }>({
    url: '/api/zaier/getzaierstatus',
    method: 'POST',
    data: params
  });
};
```

**创建AI测评**
```typescript
export const createInterviewExam = (zaierApplyPin: string) => {
  return requestPromise<{
    id: number;
    duration: number;
    starttime: string;
    status: 0 | 1;
  }>({
    url: '/api/zaier/interview/exam',
    method: 'POST',
    data: { zaierApplyPin, interMode: 2 }
  });
};
```

**获取测评题目**
```typescript
export const queryInterviewQuestion = (aiExamId: number, curQuestionId: number) => {
  const data: {
    aiExamId: number;
    curQuestionId?: number;
    withTTSFile?: boolean;
  } = { aiExamId };
  
  if (curQuestionId) {
    data.curQuestionId = curQuestionId;
  }
  
  // Android特殊处理，需要使用在线url语音
  // #ifdef APP-PLUS
  if (plus.os.name === 'Android') {
    data.withTTSFile = true;
  }
  // #endif
  
  return requestPromise<{
    base64Voice: string;
    ttsPath?: string;
    isFinal: boolean;
    id: number;
    title: string;
    content: string;
    index: number;
    totalCount: number;
  }>({
    url: '/api/zaier/interview/exam_ques',
    method: 'GET',
    data
  });
};
```

**获取测评报告**
```typescript
export const queryCertificationReport = (zaierApplyPin: string) => {
  return requestPromise<{
    basicInfo: {
      education: string;
      gender: number;
      name: string;
      serviceYear: number;
    };
    detailData: {
      totalScore: number;
      factorDetail?: ReportFactorDetail[];
    };
    proposal: {
      interview: string[];
      skill: string[];
    };
    questionAnalysis: Array<{
      id: number;
      answer: string;
      refer_ans_idea: string;
      score: number;
      score_analysis: string;
      title: string;
    }>;
    summaryAnalysis: Array<{
      id: number;
      name: string;
      score: number;
      summary: string;
      analysis: string;
    }>;
    salary: {
      avg: number[];
      my: [number, number];
    };
    summaryData: Array<{
      factorName: string;
      factorScorePercent: number;
    }>;
    summaryNote: string;
    datasource: 'eval' | 'ai';
    zaierApplyPin: string;
    fid: number;
    isDefaultReport: boolean;
  }>({
    url: `/api/zaier/eval/report?type=report&zaierApplyPin=${zaierApplyPin}`,
    method: 'GET'
  });
};
```

#### 职位匹配接口

**获取匹配职位列表**
```typescript
export const queryMatchWorkList = (payload: {
  fid: number;
  pageNumber: number;
  pageSize: number;
  type: 0 | 1 | 2 | 3;
}) => {
  return requestPromise<{
    data: Array<{
      canRefreshMatch?: boolean;
      matchPin: string;
      zaierFieldName: string;
      zaierLevel: number;
      workName: string;
      workFid: number;
      workFieldName: string;
      workMinLevel: number;
      workMaxLevel: number;
      workMinSalary: number;
      workMaxSalary: number;
      workBonusMonth: number;
      workCity: `${number},${number}`;
      workStatus: number;
      workResponsibility: string;
      entityShortname: string;
      entityName: string;
      entityDepartment: string;
      matchDegree: number;
      zaierInterestTime: number;
      zaierRejectTime: number;
      entityInterestTime: number;
      entityRejectTime: number;
      remainingTime: number;
    }>;
    count: number;
    pageSize: number;
    pageNumber: number;
  }>({
    url: '/api/zaier/getmatchworklist',
    method: 'POST',
    data: payload,
    pickKeys: ['count', 'pageSize', 'pageNumber']
  });
};
```

**职位交互**
```typescript
// 表达兴趣
export const updateWorkInteresting = (matchPin: string) => {
  return requestPromise({
    url: '/api/zaier/interestmatchwork',
    method: 'POST',
    data: { matchPin }
  });
};

// 拒绝职位
export const updateWorkReject = (matchPin: string, reason?: string) => {
  return requestPromise({
    url: '/api/zaier/rejectmatchwork',
    method: 'POST',
    data: { 
      matchPin,
      rejectReason: reason ?? ''
    }
  });
};

// 收藏职位
export const updateMatchWorkCollectStatus = (workPin: string, isCollect: boolean) => {
  return requestPromise({
    url: '/api/zaier/collectwork',
    method: 'POST',
    data: {
      workPin,
      isCollect: isCollect ? 1 : 0
    }
  });
};
```

#### 职位搜索接口

**获取职位列表**
```typescript
export const queryWorkList = (payload: {
  fid: number;
  city?: string;
  recruitType?: number;
  source?: number;
  urgent?: number;
  keyword?: string;
  pageNumber: number;
  pageSize: number;
}) => {
  if (Number(payload?.city) === -1) {
    delete payload.city;
  }
  
  return requestPromise<{
    data: Array<{
      pin: string;
      canRefreshMatch?: boolean;
      entityPin: string;
      fid: number;
      fName: string;
      name: string;
      entityName: string;
      entityShortname: string;
      responsibility: string;
      requirement: string;
      experience: 0 | 1 | 2 | 3 | 4 | 5;
      education: 0 | 1 | 2 | 3 | 4;
      type: number;
      city: string;
      minLevel: number;
      maxLevel: number;
      benefit: string;
      minSalary: number;
      maxSalary: number;
      salaryCycle: number;
      bonusMonth: number;
      entityDepartment: string;
      publishTime: number;
      matchPin: string | null;
      matchDegree: number | null;
      zaierInterestTime: number | null;
      zaierRejectTime: number | null;
      entityInterestTime: number | null;
      isMatchByZaier: number;
      urgent: number;
      source: 0 | 1 | 2 | 9;
      sincerity?: number;
    }>;
    count: number;
    pageSize: number;
    pageNumber: number;
  }>({
    url: '/api/zaier/getworklist',
    method: 'POST',
    data: { ...payload },
    pickKeys: ['count', 'pageSize', 'pageNumber']
  });
};
```

**获取职位详情**
```typescript
export const queryWorkDetail = (workPin: string) => {
  return requestPromise<{
    pin: string;
    entityPin: string;
    fid: number;
    fName: string;
    name: string;
    entityName: string;
    entityShortname: string;
    entityAddress: string;
    entityDescription: string;
    responsibility: string;
    requirement: string;
    experience: number;
    education: number;
    type: number;
    minLevel: number;
    maxLevel: number;
    city: string;
    benefit: string;
    minSalary: number;
    maxSalary: number;
    salaryCycle: number;
    bonusMonth: number;
    entityDepartment: string;
    teamDescription: string;
    productLabel: string;
    publishTime: number;
    publisher: string;
    viewCount: number;
    matchPin: string | null;
    matchDegree: number | null;
    zaierInterestTime: number | null;
    zaierRejectTime: number | null;
    entityInterestTime: number | null;
    entityRejectTime: number | null;
    isMatchByZaier: 0 | 1;
    hasResume: 0 | 1;
    hasAiExam: 0 | 1;
    hasFieldExam: 0 | 1;
    isCollect: 0 | 1;
    isApply: 0 | 1;
    isInvite: 0 | 1;
  }>({
    url: '/api/zaier/getworkdetail',
    method: 'POST',
    data: { workPin }
  });
};
```

## 5. 数据格式和转换

### 5.1 简历数据转换

后端返回的简历数据中，某些字段以JSON字符串形式存储，需要在前端进行序列化和反序列化处理。

#### 数据转换工具 (`utils/resume.ts`)

```typescript
const dealResume = () => {
  const keys: (keyof ResumeResponse)[] = [
    'certificate',
    'educationExperience', 
    'workExperience',
    'projectExperience',
    'publicInfo'
  ];
  
  return {
    // 解析：字符串 → 对象
    parse(data: ResumeResponse): Resume {
      const keysResult = keys.reduce<Resume>((obj, key) => {
        const keyData = jsonUtil.jsonParse<Resume[typeof key]>(data[key] as string, []);
        return { ...obj, [key]: keyData };
      }, {} as Resume);
      return { ...data, ...keysResult };
    },
    // 序列化：对象 → 字符串
    stringify(data: Partial<Resume>): ResumeResponse {
      const keysResult = keys.reduce<ResumeResponse>((obj, key) => {
        const keyData = jsonUtil.jsonStringify(data[key]);
        return { ...obj, [key]: keyData };
      }, {} as ResumeResponse);
      return { ...data, ...keysResult };
    }
  };
};

export const resumeUtil = dealResume();
```

#### 数据类型定义

**API返回格式 (ResumeResponse)**:
```typescript
interface ResumeResponse {
  pin: string;
  name: string;
  gender: number;
  birthday: number;
  email: string;
  professionAbility: string;
  // 以下字段为JSON字符串
  educationExperience: string;  // "[{\"dates\":[start,end],\"schoolName\":\"...\"}]"
  workExperience: string;       // 工作经历JSON字符串
  projectExperience: string;    // 项目经历JSON字符串
  certificate: string;         // 资质证书JSON字符串
  publicInfo: string;          // 公开信息JSON字符串
  selfEvaluation: string;
  mobile: string;
}
```

**前端使用格式 (Resume)**:
```typescript
type Resume = Omit<
  ResumeResponse,
  'educationExperience' | 'workExperience' | 'projectExperience' | 'certificate' | 'publicInfo'
> & {
  educationExperience: EducationExperience[];  // 解析后的对象数组
  workExperience: WorkExperience[];            // 解析后的对象数组
  projectExperience: ProjectExperience[];      // 解析后的对象数组
  certificate: Certificate[];                  // 解析后的对象数组
  publicInfo: PublicInfo[];                    // 解析后的对象数组
  savePart?: string;
};
```

#### 具体数据结构

```typescript
interface EducationExperience {
  dates: [number, number];    // [开始时间戳, 结束时间戳]
  schoolName: string;         // 学校名称
  schoolType: number;         // 学校类型
  majorName: string;          // 专业名称
}

interface WorkExperience {
  dates: [number, number];    // [开始时间戳, 结束时间戳]
  enterpriseName: string;     // 企业名称
  departmentName: string;     // 部门名称
  positionSummary: string;    // 职位描述
  positionName: string;       // 职位名称
}

interface ProjectExperience {
  dates: [number, number];    // [开始时间戳, 结束时间戳]
  projectName: string;        // 项目名称
  projectRole: string;        // 项目角色
  projectDesc: string;        // 项目描述
}

interface Certificate {
  certificateName: string;    // 证书名称
  certificateCode: string;    // 证书编号
  dates: number;              // 获得时间戳
}

interface PublicInfo {
  publicInfoName: string;     // 媒体名称
  publicInfoUrl: string;      // 信息链接
}
```

### 5.2 通用JSON处理工具

```typescript
function jsonParse<T>(data: string, defaultValue?: T): T {
  try {
    return JSON.parse(data);
  } catch (error) {
    return defaultValue;
  }
}

function jsonStringify(data: unknown): string {
  try {
    return JSON.stringify(data);
  } catch (error) {
    return ''
  }
}

export const jsonUtil = {
  jsonParse,
  jsonStringify
}
```

### 5.3 数据使用流程

**获取简历数据流程**:
```typescript
// 1. 从API获取原始数据
const resumeResponse = await queryResume();

// 2. 解析JSON字符串字段
const resume = resumeUtil.parse(resumeResponse);

// 3. 在组件中使用解析后的数据
resume.educationExperience.forEach(edu => {
  console.log(edu.schoolName, edu.majorName);
});
```

**保存简历数据流程**:
```typescript
// 1. 从表单获取用户输入
const resumeData: Resume = {
  // ... 用户填写的数据
  educationExperience: [
    { dates: [start, end], schoolName: '...', schoolType: 1, majorName: '...' }
  ]
};

// 2. 序列化对象字段为JSON字符串
const resumeRequest = resumeUtil.stringify(resumeData);

// 3. 发送到API
await updateResume(resumeRequest);
```

## 6. 错误处理机制

### 6.1 错误类型定义

```typescript
export class CustomError extends Error {
  errorno: number;
  msg: string;

  constructor(errorno: number, msg: string) {
    super(msg);
    this.errorno = errorno;
    this.msg = msg;
  }
}
```

### 6.2 统一错误处理

**在请求封装中的错误处理**:
```typescript
export function requestPromise<T>(object: RequestParams): Promise<T> {
  return new Promise((resolve, reject) => {
    request({
      ...requestOptions,
      success(res) {
        const response = res.data as RequestResult<T>
        if (response.errno !== 0) {
          const error = new CustomError(response.errno, response.msg)
          reject(error)
          
          // 特殊错误码处理
          if ([100000, 100008].includes(response.errno)) {
            // Token失效，清除用户状态，弹出登录界面
            tokenMethod.clear();
            const userStore = useUserStore()
            userStore.setUserinfo({} as any)
            if (!requestOptions.url?.includes('/user/getinfo')) {
              const pageWrapperStore = usePageWrapperStore()
              pageWrapperStore.setLoginVisible(true)
            }
          }
        } else {
          resolve(response.data)
        }
      },
      fail(e) {
        if (e?.errMsg.includes('request:fail abort')) {
          uni.showToast({
            icon: 'none',
            title: '请求失败，请检查网络~'
          })
        }
      }
    })
  })
}
```

### 6.3 业务层错误处理

**在组件中的错误处理**:
```typescript
const handleSubmit = async () => {
  try {
    loading.value = true;
    const result = await updateResume(resumeData);
    uni.showToast({
      title: '保存成功',
      icon: 'success'
    });
  } catch (error) {
    const customError = error as CustomError;
    uni.showToast({
      title: customError.msg || '保存失败',
      icon: 'none'
    });
  } finally {
    loading.value = false;
  }
};
```

### 6.4 常见错误码

| 错误码 | 含义 | 处理方式 |
|--------|------|----------|
| 0 | 成功 | 正常处理响应数据 |
| 100000 | 未登录 | 清除本地状态，弹出登录界面 |
| 100008 | Token失效 | 清除本地状态，弹出登录界面 |
| 其他 | 业务错误 | 显示错误信息给用户 |

## 7. 环境配置和部署

### 7.1 环境配置

**开发环境** (`vite.config.ts`):
```typescript
export default defineConfig({
  server: {
    proxy: {
      '/api': {
        target: 'http://dev.zizai.work/',
        changeOrigin: true,
      }
    }
  },
  base: process.env.NODE_ENV === 'production' ? '/static-m/' : '/',
})
```

**生产环境**:
- H5版本部署到CDN，使用`/static-m/`作为基础路径
- App版本直接请求生产环境API
- 小程序版本需要配置服务器域名白名单

### 7.2 跨平台适配

**条件编译处理不同平台的API差异**:
```typescript
// #ifndef H5
if (!object.url.startsWith('http')) {
  object.url = BASE_URL + object.url;
}
// #endif

// #ifdef APP-PLUS
if (plus.os.name === 'Android') {
  data.withTTSFile = true;
}
// #endif
```

## 8. 性能优化策略

### 8.1 请求优化

1. **请求合并**: 使用`pickKeys`参数只获取需要的字段
2. **缓存策略**: Store中缓存常用数据，减少重复请求
3. **超时控制**: 为耗时接口设置合理的超时时间
4. **重试机制**: 网络失败时自动重试

### 8.2 数据优化

1. **懒加载**: 按需加载数据，减少初始化时间
2. **分页加载**: 大列表数据分页获取
3. **数据预取**: 预先加载可能需要的数据
4. **增量更新**: 只传输变化的数据

## 9. 开发最佳实践

### 9.1 接口调用规范

1. **统一使用requestPromise**: 获得完整的错误处理和类型支持
2. **明确接口类型**: 为每个接口定义清晰的TypeScript类型
3. **合理处理异常**: 在业务层正确处理和展示错误信息
4. **避免重复请求**: 通过状态管理避免不必要的重复调用

### 9.2 数据管理规范

1. **数据转换**: 在Service层进行数据格式转换，保持组件层的纯净
2. **状态同步**: 及时更新Store中的数据状态
3. **类型安全**: 充分利用TypeScript的类型检查能力
4. **数据持久化**: 合理使用本地存储，平衡性能和数据一致性

### 9.3 错误处理规范

1. **分层处理**: 在不同层级进行合适的错误处理
2. **用户友好**: 提供清晰、可操作的错误提示
3. **错误上报**: 记录关键错误信息用于问题排查
4. **优雅降级**: 在网络异常时提供备选方案

## 10. 总结

自在招聘的后端交互系统设计完善，具有以下特点：

### 优势
1. **统一封装**: 完整的请求封装和错误处理机制
2. **类型安全**: 全面的TypeScript类型定义
3. **权限完善**: 灵活的认证和权限控制系统
4. **跨平台适配**: 支持多端统一的API调用
5. **用户体验**: 无感知的token更新和登录引导

### 技术特色
1. **响应式状态管理**: 基于Pinia的现代状态管理
2. **智能数据转换**: 自动处理复杂数据格式
3. **多种登录方式**: 适配不同平台的用户习惯
4. **完善的错误处理**: 统一的异常处理和用户提示

这套系统为复杂的求职招聘业务提供了稳定、高效的数据交互基础，既保证了代码的可维护性，又提供了优秀的用户体验。