# 任务规划 - 完善文件预览打印功能

## 任务概述
完善 file_preview_layer.tsx 中第166行的打印功能，当前打印功能不完善，只支持部分文件类型且实现不完整。

## 需求分析
### 当前问题分析
1. **打印功能不完整**：
   - PDF打印：`onPrintFile()` 方法为空实现
   - Excel打印：`onPrintFile()` 方法为空实现
   - 其他文件类型：没有打印支持

2. **支持的文件类型有限**：
   - 仅处理 PDF 和 Excel 文件
   - 对于 .xls 文件直接跳过打印
   - 其他文件类型（Word、PPT、图片等）没有打印功能

3. **用户体验问题**：
   - 点击打印按钮没有反馈
   - 没有错误处理机制
   - 缺少打印状态提示

## 影响范围评估
### 可能影响的文件和功能模块
- `src/components/file_preview/file_preview_layer.tsx` - 主要修改文件
- `src/components/file_preview/widget/pdf_viewer.tsx` - PDF打印实现
- `src/components/file_preview/widget/excel_viewer.tsx` - Excel打印实现
- `src/components/file_preview/widget/word_docx_viewer.tsx` - 新增Word打印
- `src/components/file_preview/widget/image_viewer.tsx` - 新增图片打印
- 其他viewer组件 - 可能需要新增打印支持

## 实施计划
### 待办事项
- [ ] 实现PDF文件打印功能
- [ ] 实现Excel文件打印功能（包括.xls格式）
- [ ] 实现Word文档打印功能
- [ ] 实现图片打印功能
- [ ] 实现PPT/PPTX打印功能
- [ ] 实现文本文件打印功能
- [ ] 添加打印状态提示和错误处理
- [ ] 优化打印按钮UI交互
- [ ] 添加打印预览功能（可选）
- [ ] 测试所有支持的文件类型打印功能

### 风险评估
- **低风险**：现有打印功能基本为空实现，不会影响现有功能
- **中等风险**：需要修改多个viewer组件，可能影响文件预览功能
- **注意事项**：
  - 浏览器打印API兼容性问题
  - 大文件打印可能导致性能问题
  - 不同文件格式打印效果可能不一致

## 实施进展
[实时更新任务完成情况]

## 测试计划
### 测试方案
1. **功能测试**：
   - 测试各种文件类型的打印功能
   - 测试打印按钮的交互反馈
   - 测试错误处理机制

2. **兼容性测试**：
   - 测试不同浏览器的打印效果
   - 测试移动端打印功能

3. **性能测试**：
   - 测试大文件打印性能
   - 测试并发打印场景

### 验收标准
- 所有支持的文件类型都能正常打印
- 打印按钮有明确的状态反馈
- 错误情况能够正确提示用户
- 不影响现有文件预览功能

## 完成总结
[任务完成后的总结和经验]