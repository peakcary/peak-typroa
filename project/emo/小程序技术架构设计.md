# æƒ…ç»ªç–—æ„ˆå°ç¨‹åºæŠ€æœ¯æ¶æ„è®¾è®¡

## ğŸ—ï¸ æ•´ä½“æ¶æ„æ¦‚è§ˆ

```
ç”¨æˆ·å±‚ (UI Layer)
    â†“
ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic)
    â†“
æ•°æ®æœåŠ¡å±‚ (Data Service)
    â†“
äº‘ç«¯å­˜å‚¨å±‚ (Cloud Storage)
```

## ğŸ“± å‰ç«¯æ¶æ„è®¾è®¡

### é¡µé¢ç»“æ„
```
å°ç¨‹åºé¡µé¢æ¶æ„:
â”œâ”€â”€ é¦–é¡µ (index)           # æƒ…ç»ªè®°å½•å…¥å£
â”œâ”€â”€ è®°å½•é¡µ (record)        # è¯¦ç»†æƒ…ç»ªè®°å½•
â”œâ”€â”€ åˆ†æé¡µ (analysis)      # æ•°æ®åˆ†æå±•ç¤º
â”œâ”€â”€ æˆ‘çš„ (profile)         # ä¸ªäººä¸­å¿ƒ
â”œâ”€â”€ ç¤¾åŒº (community)       # ç¤¾åŒºäº’åŠ¨
â””â”€â”€ è®¾ç½® (settings)        # åº”ç”¨è®¾ç½®
```

### ç»„ä»¶åŒ–è®¾è®¡
```javascript
// æ ¸å¿ƒç»„ä»¶ç»“æ„
components/
â”œâ”€â”€ emotion-selector/      # æƒ…ç»ªé€‰æ‹©å™¨ç»„ä»¶
â”‚   â”œâ”€â”€ color-picker/     # è‰²å½©æƒ…ç»ªé€‰æ‹©
â”‚   â”œâ”€â”€ weather-mood/     # å¤©æ°”æƒ…ç»ªé€‰æ‹©
â”‚   â””â”€â”€ emoji-picker/     # è¡¨æƒ…ç¬¦å·é€‰æ‹©
â”œâ”€â”€ charts/               # å›¾è¡¨ç»„ä»¶
â”‚   â”œâ”€â”€ mood-chart/      # æƒ…ç»ªè¶‹åŠ¿å›¾
â”‚   â”œâ”€â”€ calendar-heat/   # æƒ…ç»ªæ—¥å†çƒ­åŠ›å›¾
â”‚   â””â”€â”€ analysis-card/   # åˆ†æå¡ç‰‡
â”œâ”€â”€ input/               # è¾“å…¥ç»„ä»¶
â”‚   â”œâ”€â”€ voice-recorder/  # è¯­éŸ³è®°å½•
â”‚   â”œâ”€â”€ text-editor/     # æ–‡æœ¬ç¼–è¾‘å™¨
â”‚   â””â”€â”€ quick-tags/      # å¿«é€Ÿæ ‡ç­¾
â””â”€â”€ common/              # é€šç”¨ç»„ä»¶
    â”œâ”€â”€ loading/         # åŠ è½½åŠ¨ç”»
    â”œâ”€â”€ modal/          # å¼¹çª—ç»„ä»¶
    â””â”€â”€ button/         # æŒ‰é’®ç»„ä»¶
```

## â˜ï¸ åç«¯æ¶æ„è®¾è®¡

### äº‘å¼€å‘æœåŠ¡æ¶æ„
```yaml
äº‘å‡½æ•° (Cloud Functions):
  emotion-analysis:      # æƒ…ç»ªåˆ†ææœåŠ¡
    - æ–‡æœ¬æƒ…æ„Ÿåˆ†æ
    - è¯­éŸ³è½¬æ–‡å­—å¤„ç†
    - AIæ´å¯Ÿç”Ÿæˆ
    
  user-service:          # ç”¨æˆ·æœåŠ¡
    - ç”¨æˆ·ä¿¡æ¯ç®¡ç†
    - æƒé™æ§åˆ¶
    - æ•°æ®åŒæ­¥
    
  data-statistics:       # æ•°æ®ç»Ÿè®¡æœåŠ¡
    - æƒ…ç»ªè¶‹åŠ¿åˆ†æ
    - ä¸ªäººæ´å¯Ÿç”Ÿæˆ
    - æŠ¥å‘Šè‡ªåŠ¨ç”Ÿæˆ
    
  community-service:     # ç¤¾åŒºæœåŠ¡
    - åŒ¿ååˆ†äº«å¤„ç†
    - å†…å®¹å®¡æ ¸
    - äº’åŠ¨ç®¡ç†

äº‘æ•°æ®åº“ (Database):
  users:                 # ç”¨æˆ·è¡¨
  emotions:              # æƒ…ç»ªè®°å½•è¡¨
  analysis_results:      # åˆ†æç»“æœè¡¨
  community_posts:       # ç¤¾åŒºåŠ¨æ€è¡¨
  user_achievements:     # ç”¨æˆ·æˆå°±è¡¨
```

### æ•°æ®æ¨¡å‹è®¾è®¡
```javascript
// ç”¨æˆ·è¡¨ç»“æ„
const UserSchema = {
  _id: String,           // ç”¨æˆ·ID
  openid: String,        // å¾®ä¿¡openid
  nickname: String,      // æ˜µç§°
  avatar: String,        // å¤´åƒURL
  created_at: Date,      // åˆ›å»ºæ—¶é—´
  privacy_level: Number, // éšç§ç­‰çº§ 1-3
  settings: Object       // ç”¨æˆ·è®¾ç½®
}

// æƒ…ç»ªè®°å½•è¡¨ç»“æ„  
const EmotionSchema = {
  _id: String,           // è®°å½•ID
  user_id: String,       // ç”¨æˆ·ID
  emotion_type: String,  // æƒ…ç»ªç±»å‹
  intensity: Number,     // å¼ºåº¦ 1-10
  tags: Array,          // æ ‡ç­¾æ•°ç»„
  description: String,   // æ–‡å­—æè¿°
  trigger_event: String, // è§¦å‘äº‹ä»¶
  location: String,      // åœ°ç†ä½ç½®(å¯é€‰)
  weather: String,       // å¤©æ°”æƒ…å†µ
  created_time: Date,    // è®°å½•æ—¶é—´
  analysis_result: Object // AIåˆ†æç»“æœ
}

// åˆ†æç»“æœè¡¨ç»“æ„
const AnalysisSchema = {
  _id: String,           // åˆ†æID
  user_id: String,       // ç”¨æˆ·ID
  period: String,        // åˆ†æå‘¨æœŸ (daily/weekly/monthly)
  emotion_summary: Object,// æƒ…ç»ªæ±‡æ€»
  patterns: Array,       // å‘ç°çš„æ¨¡å¼
  insights: Array,       // AIæ´å¯Ÿ
  suggestions: Array,    // æ”¹å–„å»ºè®®
  generated_at: Date     // ç”Ÿæˆæ—¶é—´
}
```

## ğŸ¤– AIæœåŠ¡é›†æˆ

### æƒ…æ„Ÿåˆ†ææµç¨‹
```javascript
// AIåˆ†æå¤„ç†æµç¨‹
const emotionAnalysisFlow = {
  // 1. æ•°æ®é¢„å¤„ç†
  preprocessing: {
    textCleaning: "å»é™¤æ•æ„Ÿä¿¡æ¯ï¼Œæ•°æ®è„±æ•",
    featureExtraction: "æå–æƒ…ç»ªç‰¹å¾è¯",
    contextAnalysis: "åˆ†æä¸Šä¸‹æ–‡ä¿¡æ¯"
  },
  
  // 2. AIæ¨¡å‹è°ƒç”¨
  aiAnalysis: {
    sentimentAPI: "è°ƒç”¨ç™¾åº¦/è…¾è®¯æƒ…æ„Ÿåˆ†æAPI",
    localModel: "æœ¬åœ°è½»é‡çº§æ¨¡å‹è¾…åŠ©",
    confidenceCheck: "ç½®ä¿¡åº¦éªŒè¯"
  },
  
  // 3. ç»“æœåå¤„ç†
  postprocessing: {
    resultFusion: "å¤šæ¨¡å‹ç»“æœèåˆ",
    insightGeneration: "ç”Ÿæˆä¸ªæ€§åŒ–æ´å¯Ÿ",
    suggestionMatch: "åŒ¹é…æ”¹å–„å»ºè®®"
  }
}
```

### APIæ¥å£è®¾è®¡
```javascript
// æ ¸å¿ƒAPIæ¥å£
const APIEndpoints = {
  // æƒ…ç»ªè®°å½•ç›¸å…³
  POST: "/api/emotion/record",      // åˆ›å»ºæƒ…ç»ªè®°å½•
  GET: "/api/emotion/list",         // è·å–è®°å½•åˆ—è¡¨
  PUT: "/api/emotion/update",       // æ›´æ–°è®°å½•
  DELETE: "/api/emotion/delete",    // åˆ é™¤è®°å½•
  
  // AIåˆ†æç›¸å…³
  POST: "/api/analysis/emotion",    // æƒ…ç»ªåˆ†æ
  GET: "/api/analysis/insights",    // è·å–æ´å¯Ÿ
  GET: "/api/analysis/trends",      // è·å–è¶‹åŠ¿
  POST: "/api/analysis/report",     // ç”ŸæˆæŠ¥å‘Š
  
  // ç”¨æˆ·ç³»ç»Ÿ
  POST: "/api/user/profile",        // ç”¨æˆ·èµ„æ–™
  PUT: "/api/user/settings",        // æ›´æ–°è®¾ç½®
  GET: "/api/user/achievements",    // è·å–æˆå°±
  
  // ç¤¾åŒºåŠŸèƒ½
  POST: "/api/community/share",     // åŒ¿ååˆ†äº«
  GET: "/api/community/feed",       // è·å–åŠ¨æ€
  POST: "/api/community/interact"   // äº’åŠ¨æ“ä½œ
}
```

## ğŸ”’ æ•°æ®å®‰å…¨æ¶æ„

### éšç§ä¿æŠ¤ç­–ç•¥
```yaml
æ•°æ®åŠ å¯†:
  ä¼ è¾“åŠ å¯†: HTTPS + SSLè¯ä¹¦
  å­˜å‚¨åŠ å¯†: äº‘æ•°æ®åº“å­—æ®µçº§åŠ å¯†
  æ•æ„Ÿä¿¡æ¯: AES-256æœ¬åœ°åŠ å¯†åå­˜å‚¨
  
æƒé™æ§åˆ¶:
  ç”¨æˆ·çº§æƒé™: åŸºäºopenidçš„ç”¨æˆ·éš”ç¦»
  åŠŸèƒ½çº§æƒé™: æ ¹æ®éšç§ç­‰çº§æ§åˆ¶åŠŸèƒ½è®¿é—®
  æ•°æ®çº§æƒé™: ç»†ç²’åº¦çš„æ•°æ®è®¿é—®æ§åˆ¶
  
æ•°æ®æœ€å°åŒ–:
  æ”¶é›†æœ€å°åŒ–: åªæ”¶é›†å¿…è¦çš„åŠŸèƒ½æ•°æ®
  å­˜å‚¨æœ€å°åŒ–: å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
  ä½¿ç”¨æœ€å°åŒ–: AIåˆ†ææ—¶æ•°æ®è„±æ•å¤„ç†
```

### åˆè§„æ€§è®¾è®¡
```javascript
// éšç§åˆè§„æ£€æŸ¥ç‚¹
const privacyCheckpoints = {
  dataCollection: {
    userConsent: "æ˜ç¡®çš„ç”¨æˆ·åŒæ„",
    purposeLimit: "æ•°æ®ä½¿ç”¨ç›®çš„é™åˆ¶",
    minimalData: "æœ€å°åŒ–æ•°æ®æ”¶é›†"
  },
  
  dataProcessing: {
    anonymization: "æ•°æ®åŒ¿ååŒ–å¤„ç†", 
    encryption: "æ•æ„Ÿæ•°æ®åŠ å¯†",
    accessLog: "æ•°æ®è®¿é—®æ—¥å¿—è®°å½•"
  },
  
  dataStorage: {
    retentionPolicy: "æ•°æ®ä¿ç•™æœŸé™æ”¿ç­–",
    deleteRight: "ç”¨æˆ·åˆ é™¤æƒå®ç°",
    exportRight: "æ•°æ®å¯¼å‡ºæƒå®ç°"
  }
}
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–æ¶æ„

### å‰ç«¯æ€§èƒ½ä¼˜åŒ–
```javascript
// æ€§èƒ½ä¼˜åŒ–ç­–ç•¥
const performanceOptimization = {
  // é¡µé¢åŠ è½½ä¼˜åŒ–
  pageLoading: {
    lazyLoading: "å›¾ç‰‡å’Œç»„ä»¶æ‡’åŠ è½½",
    preloading: "å…³é”®èµ„æºé¢„åŠ è½½",  
    caching: "é™æ€èµ„æºæœ¬åœ°ç¼“å­˜"
  },
  
  // æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–
  rendering: {
    virtualList: "é•¿åˆ—è¡¨è™šæ‹Ÿæ»šåŠ¨",
    debounce: "è¾“å…¥é˜²æŠ–å¤„ç†",
    throttle: "æ»šåŠ¨èŠ‚æµæ§åˆ¶"
  },
  
  // æ•°æ®å¤„ç†ä¼˜åŒ–
  dataProcessing: {
    localCache: "æœ¬åœ°æ•°æ®ç¼“å­˜ç­–ç•¥",
    batchUpdate: "æ‰¹é‡æ•°æ®æ›´æ–°",
    compression: "æ•°æ®å‹ç¼©ä¼ è¾“"
  }
}
```

### åç«¯æ€§èƒ½ä¼˜åŒ–
```yaml
äº‘å‡½æ•°ä¼˜åŒ–:
  å†·å¯åŠ¨ä¼˜åŒ–: ä¿æŒäº‘å‡½æ•°æ¸©çƒ­çŠ¶æ€
  å¹¶å‘æ§åˆ¶: åˆç†è®¾ç½®å¹¶å‘é™åˆ¶
  èµ„æºå¤ç”¨: æ•°æ®åº“è¿æ¥æ± å¤ç”¨
  
æ•°æ®åº“ä¼˜åŒ–:
  ç´¢å¼•è®¾è®¡: å…³é”®æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
  æŸ¥è¯¢ä¼˜åŒ–: é¿å…å…¨è¡¨æ‰«ææŸ¥è¯¢
  æ•°æ®åˆ†ç‰‡: å¤§æ•°æ®é›†åˆç†åˆ†ç‰‡å­˜å‚¨
  
ç¼“å­˜ç­–ç•¥:
  çƒ­ç‚¹æ•°æ®: Redisç¼“å­˜çƒ­ç‚¹æŸ¥è¯¢
  é™æ€èµ„æº: CDNåŠ é€Ÿé™æ€èµ„æº
  APIç¼“å­˜: æ¥å£ç»“æœç¼“å­˜æœºåˆ¶
```

## ğŸ”„ å¼€å‘éƒ¨ç½²æµç¨‹

### å¼€å‘ç¯å¢ƒé…ç½®
```bash
# å¼€å‘ç¯å¢ƒä¾èµ–
å¼€å‘å·¥å…·: å¾®ä¿¡å¼€å‘è€…å·¥å…· (æœ€æ–°ç‰ˆ)
ç¼–è¾‘å™¨: VS Code + å°ç¨‹åºæ’ä»¶
ç‰ˆæœ¬æ§åˆ¶: Git + GitHub/Gitee
åŒ…ç®¡ç†: npm/yarn

# é¡¹ç›®åˆå§‹åŒ–å‘½ä»¤
npm install                    # å®‰è£…ä¾èµ–
npm run dev                   # å¯åŠ¨å¼€å‘æ¨¡å¼  
npm run build:dev            # æ„å»ºå¼€å‘ç‰ˆæœ¬
npm run deploy:cloud         # éƒ¨ç½²äº‘å‡½æ•°
```

### éƒ¨ç½²æ¶æ„
```yaml
éƒ¨ç½²ç¯å¢ƒ:
  å¼€å‘ç¯å¢ƒ: æœ¬åœ° + äº‘å¼€å‘å¼€å‘ç¯å¢ƒ
  æµ‹è¯•ç¯å¢ƒ: äº‘å¼€å‘æµ‹è¯•ç¯å¢ƒ
  ç”Ÿäº§ç¯å¢ƒ: äº‘å¼€å‘æ­£å¼ç¯å¢ƒ
  
å‘å¸ƒæµç¨‹:
  1. æœ¬åœ°å¼€å‘æµ‹è¯•
  2. äº‘å¼€å‘ç¯å¢ƒæµ‹è¯•  
  3. å°ç¨‹åºåå°æäº¤å®¡æ ¸
  4. å®¡æ ¸é€šè¿‡åå‘å¸ƒä¸Šçº¿
  
ç‰ˆæœ¬ç®¡ç†:
  ä¸»åˆ†æ”¯: main (ç”Ÿäº§ç¯å¢ƒ)
  å¼€å‘åˆ†æ”¯: develop (å¼€å‘ç¯å¢ƒ)
  åŠŸèƒ½åˆ†æ”¯: feature/* (åŠŸèƒ½å¼€å‘)
```

## ğŸ“ˆ ç›‘æ§è¿ç»´æ¶æ„

### æ€§èƒ½ç›‘æ§
```javascript
// å…³é”®æŒ‡æ ‡ç›‘æ§
const monitoringMetrics = {
  performance: {
    pageLoadTime: "é¡µé¢åŠ è½½æ—¶é—´",
    apiResponseTime: "APIå“åº”æ—¶é—´", 
    crashRate: "å°ç¨‹åºå´©æºƒç‡",
    memoryUsage: "å†…å­˜ä½¿ç”¨æƒ…å†µ"
  },
  
  business: {
    activeUsers: "æ—¥æ´»è·ƒç”¨æˆ·æ•°",
    recordCount: "æƒ…ç»ªè®°å½•æ•°é‡",
    analysisAccuracy: "AIåˆ†æå‡†ç¡®ç‡",
    userRetention: "ç”¨æˆ·ç•™å­˜ç‡"
  },
  
  errors: {
    jsErrors: "JSé”™è¯¯ç»Ÿè®¡",
    apiErrors: "APIé”™è¯¯ç»Ÿè®¡", 
    cloudFunctionErrors: "äº‘å‡½æ•°é”™è¯¯"
  }
}
```

### è¿ç»´è‡ªåŠ¨åŒ–
```yaml
è‡ªåŠ¨åŒ–ä»»åŠ¡:
  æ•°æ®å¤‡ä»½: æ¯æ—¥è‡ªåŠ¨æ•°æ®åº“å¤‡ä»½
  æ—¥å¿—æ¸…ç†: å®šæœŸæ¸…ç†è¿‡æœŸæ—¥å¿—æ–‡ä»¶
  æ€§èƒ½æŠ¥å‘Š: å‘¨åº¦æ€§èƒ½åˆ†ææŠ¥å‘Š
  
å‘Šè­¦æœºåˆ¶:
  é”™è¯¯å‘Šè­¦: å¼‚å¸¸é”™è¯¯ç‡è¶…æ ‡å‘Šè­¦
  æ€§èƒ½å‘Šè­¦: å“åº”æ—¶é—´è¶…æ ‡å‘Šè­¦
  èµ„æºå‘Šè­¦: äº‘èµ„æºä½¿ç”¨ç‡å‘Šè­¦
```

---

**æ¶æ„ç‰ˆæœ¬**: v1.0  
**è®¾è®¡æ—¥æœŸ**: 2025-08-05  
**é€‚ç”¨ç¯å¢ƒ**: å¾®ä¿¡å°ç¨‹åº + äº‘å¼€å‘  
**ä¸‹æ¬¡æ›´æ–°**: æ ¹æ®å¼€å‘è¿›åº¦è°ƒæ•´ä¼˜åŒ–