âº Express é™æ€æ–‡ä»¶é…ç½®ä¿®å¤æ–‡æ¡£

  ğŸ“‹ æ¦‚è¿°

  é—®é¢˜: ExpressæœåŠ¡å™¨8058ç«¯å£æ— æ³•æ­£ç¡®æä¾›é™æ€æ–‡ä»¶ï¼Œå¯¼è‡´é¡µé¢æ¸²æŸ“å¼‚å¸¸ä¿®å¤æ—¶é—´: 2025-08-25å½±å“èŒƒå›´: /Users/peak/Work/zai-fe/go.jsä¿®å¤ç±»å‹:
  é™æ€æ–‡ä»¶æœåŠ¡é…ç½®ä¼˜åŒ–

---
  ğŸ” é—®é¢˜åˆ†æ

  ç—‡çŠ¶æè¿°

  - 8058ç«¯å£è¿”å›HTMLé¡µé¢ç»“æ„
  - JavaScriptå’ŒCSSæ–‡ä»¶è¯·æ±‚è¿”å›HTMLå†…å®¹è€Œéå®é™…æ–‡ä»¶
  - é¡µé¢æ— æ³•æ­£å¸¸æ¸²æŸ“ï¼ŒåŠŸèƒ½å¼‚å¸¸

  æ ¹æœ¬åŸå› 

  1. é™æ€æ–‡ä»¶è·¯å¾„é…ç½®é”™è¯¯ï¼šå¼€å‘ç¯å¢ƒä¸‹ä»é”™è¯¯ç›®å½•æä¾›é™æ€èµ„æº
  2. æ–‡ä»¶è·¯å¾„ä¸åŒ¹é…ï¼šæ„å»ºæ–‡ä»¶ä¸æœåŠ¡å™¨æŸ¥æ‰¾è·¯å¾„ä¸ä¸€è‡´
  3. MIMEç±»å‹æœªè®¾ç½®ï¼šç¼ºå°‘æ˜ç¡®çš„Content-Typeè®¾ç½®

---
  ğŸ“ å…·ä½“ä¿®æ”¹å†…å®¹

  ä¿®æ”¹æ–‡ä»¶

  - æ–‡ä»¶è·¯å¾„: /Users/peak/Work/zai-fe/go.js
  - ä¿®æ”¹è¡Œæ•°: ç¬¬73-74è¡Œ â†’ ç¬¬73-88è¡Œ

  ä¿®æ”¹å‰ä»£ç 

  // è®¾ç½®å…¬ç”¨èµ„æºï¼Œå¯è®¿é—®éè·¯ç”±å®šä¹‰çš„htmlé¡µé¢
  app.use(express.static(path.join(__dirname, process.env.NODE_ENV !== 'development' ? 'public' : 'client/public')));

  ä¿®æ”¹åä»£ç 

  // è®¾ç½®å…¬ç”¨èµ„æºï¼Œå¯è®¿é—®éè·¯ç”±å®šä¹‰çš„htmlé¡µé¢
  // ä¸»è¦é™æ€èµ„æºä» public ç›®å½•æä¾›ï¼ˆæ„å»ºåçš„æ–‡ä»¶ï¼‰
  app.use(express.static(path.join(__dirname, 'public'), {
    setHeaders: (res, filePath) => {
      if (filePath.endsWith('.js') || filePath.endsWith('.mjs')) {
        res.setHeader('Content-Type', 'application/javascript; charset=utf-8');
      } else if (filePath.endsWith('.css')) {
        res.setHeader('Content-Type', 'text/css; charset=utf-8');
      }
    }
  }));

  // å¼€å‘ç¯å¢ƒä¸‹é¢å¤–æä¾› client/public çš„é™æ€èµ„æºï¼ˆå¦‚ favicon ç­‰ï¼‰
  if (process.env.NODE_ENV === 'development') {
    app.use(express.static(path.join(__dirname, 'client/public')));
  }

---
  ğŸ”§ ä¿®æ”¹è¯¦ç»†è¯´æ˜

  1. ç»Ÿä¸€é™æ€æ–‡ä»¶ç›®å½•

  å˜æ›´å†…å®¹:
  - ç§»é™¤ç¯å¢ƒå˜é‡æ¡ä»¶åˆ¤æ–­
  - ç»Ÿä¸€ä» public ç›®å½•æä¾›ä¸»è¦é™æ€èµ„æº

  åŸå› :
  - æ„å»ºåçš„JS/CSSæ–‡ä»¶ä½äºæ ¹ç›®å½• public æ–‡ä»¶å¤¹
  - client/public åªåŒ…å«å¼€å‘èµ„æºï¼Œæ— æ„å»ºæ–‡ä»¶

  2. æ·»åŠ MIMEç±»å‹è®¾ç½®

  æ–°å¢åŠŸèƒ½:
  setHeaders: (res, filePath) => {
    if (filePath.endsWith('.js') || filePath.endsWith('.mjs')) {
      res.setHeader('Content-Type', 'application/javascript; charset=utf-8');
    } else if (filePath.endsWith('.css')) {
      res.setHeader('Content-Type', 'text/css; charset=utf-8');
    }
  }

  ä½œç”¨: ç¡®ä¿æµè§ˆå™¨æ­£ç¡®è§£ææ–‡ä»¶ç±»å‹

  3. åˆ†å±‚é™æ€æ–‡ä»¶æœåŠ¡

  æ–°å¢é€»è¾‘:
  - ç¬¬ä¸€å±‚: public ç›®å½•æä¾›æ„å»ºåæ–‡ä»¶
  - ç¬¬äºŒå±‚: å¼€å‘ç¯å¢ƒä¸‹é¢å¤–æä¾› client/public èµ„æº

  ä¼˜åŠ¿: å…¼å®¹å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒéœ€æ±‚

---
  ğŸ“Š ä¿®å¤æ•ˆæœéªŒè¯

  JavaScriptæ–‡ä»¶è®¿é—®æµ‹è¯•

  # ä¿®å¤å‰
  curl -I "http://localhost:8058/js/index-47f5db32.js"
  # Content-Type: text/html; charset=utf-8 âŒ

  # ä¿®å¤å
  curl -I "http://localhost:8058/js/index-47f5db32.js"
  # Content-Type: application/javascript; charset=utf-8 âœ…

  CSSæ–‡ä»¶è®¿é—®æµ‹è¯•

  # ä¿®å¤å
  curl -I "http://localhost:8058/css/index-5de8e776.css"
  # Content-Type: text/css; charset=utf-8 âœ…

---
  ğŸ¯ æŠ€æœ¯å½±å“

  æ­£é¢å½±å“

  - âœ… 8058ç«¯å£é¡µé¢æ­£å¸¸æ¸²æŸ“
  - âœ… é™æ€èµ„æºæ­£ç¡®åŠ è½½
  - âœ… MIMEç±»å‹æ ‡å‡†åŒ–
  - âœ… å¼€å‘/ç”Ÿäº§ç¯å¢ƒå…¼å®¹

  é£é™©è¯„ä¼°

  - ğŸŸ¢ é£é™©ç­‰çº§: ä½
  - ğŸŸ¢ å‘åå…¼å®¹: æ˜¯
  - ğŸŸ¢ éƒ¨ç½²å½±å“: æ— 

---
  ğŸ“ ç›¸å…³æ–‡ä»¶ç»“æ„

  /Users/peak/Work/zai-fe/
  â”œâ”€â”€ public/                 # æ„å»ºåé™æ€æ–‡ä»¶ (ä¸»è¦æœåŠ¡ç›®å½•)
  â”‚   â”œâ”€â”€ js/
  â”‚   â”‚   â””â”€â”€ index-47f5db32.js
  â”‚   â”œâ”€â”€ css/
  â”‚   â”‚   â””â”€â”€ index-5de8e776.css
  â”‚   â””â”€â”€ images/
  â””â”€â”€ client/public/          # å¼€å‘æ—¶é™æ€æ–‡ä»¶ (è¾…åŠ©æœåŠ¡)
      â”œâ”€â”€ favicon.ico
      â”œâ”€â”€ images/
      â””â”€â”€ videos/

---
  ğŸ”„ å›æ»šæ–¹æ¡ˆ

  å¦‚éœ€å›æ»šåˆ°åŸå§‹é…ç½®ï¼š

  // å›æ»šä»£ç 
  app.use(express.static(path.join(__dirname, process.env.NODE_ENV !== 'development' ? 'public' : 'client/public')));

  æ³¨æ„: å›æ»šä¼šå¯¼è‡´8058ç«¯å£é™æ€æ–‡ä»¶åŠ è½½é—®é¢˜é‡ç°

---
  âœ… éªŒæ”¶æ ‡å‡†

  - 8058ç«¯å£é¡µé¢å®Œæ•´æ¸²æŸ“
  - JavaScriptæ–‡ä»¶æ­£ç¡®Content-Typeå“åº”
  - CSSæ–‡ä»¶æ­£ç¡®Content-Typeå“åº”
  - å¼€å‘ç¯å¢ƒfaviconç­‰èµ„æºæ­£å¸¸è®¿é—®
  - 5174ç«¯å£åŠŸèƒ½ä¸å—å½±å“

  çŠ¶æ€: âœ… å…¨éƒ¨é€šè¿‡

---
  æ–‡æ¡£ç‰ˆæœ¬: 1.0æœ€åæ›´æ–°: 2025-08-25 16:07 GMT+8